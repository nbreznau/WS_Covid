---
title: 'Institutionalized Inequality and Risk Perceptions: Government Intervention
  and Social Welfare during the Novel Coronavirus Pandemic'
output:
  html_document:
    df_print: paged
---

This is a follow up study of 

Breznau, Nate. 2020. “The Welfare State and Risk Perceptions: The Novel Coronavirus Pandemic and Public Concern in 70 Countries.” *European Societies*.

The following files are necessary to run this code
coronavirus_Aug01.xlsx: https://acleddata.com/analysis/covid-19-disorder-tracker/#1585775466317-4776d559-78fe 
covid-stringency-index.csv: https://ourworldindata.org/grapher/covid-stringency-index
WID_Data_14082020-111941.xlsx         https://wid.world/data/
ZA6900_v2-0-0.dta                     ISSP RoG 2016

Solt, Frederick. 2020. "Measuring Income Inequality Across Countries and Over Time: The Standardized World Income Inequality Database." Social Science Quarterly doi: 10.1111/ssqu.12795



```{r setup}
wd <- "C:/Github" #set your working directory here

wdir <- function(x){
  paste(wd,x, sep = "/")
}


# need pacman package installed to run this
# install.packages("pacman")
pacman::p_load("dplyr","countrycode","car","ggplot2","jtools","sjPlot","sjmisc","sjlabelled","tidyverse","psych","lavaan","kableExtra","ggrepel","stringi","margins","readxl", "countrycode","haven")

```


```{r load_prep, message = F, warning = F}
## Breznau 2020

load(wdir("SPR33/cis2.RData"))
rm(list = setdiff(ls(),"finaldf_Ca"))

wd <- "C:/Github" 

wdir <- function(x){
  paste(wd,x, sep = "/")
}

# COVID-19 Survey

betrack <- read_dta(wdir("SPR33/GlobalBehaviorsPerceptions_Data_May21_2020.dta")) 

# government response
gov_resp <- read.csv(file = wdir("SPR33/OxCGRT_latest.csv"), header = T)


# ISSP RoG
issp06 <- read_dta(wdir("ZA4700.dta"))
issp16 <- read_dta(wdir("ZA6900_v2-0-0.dta"))

# Solt Gini
load(wdir("SPR33/swiid8_3.Rda"))


# Death per million

covid <- read.csv(file = wdir("SPR33/owid-covid-data.csv"), header = T)

```


```{r clean_issp, include = F}

# recode all questions so that higher values indicate support for government intervention
# colnames(issp06) <- tolower(colnames(issp06))
# issp06 <- issp06 %>%
#   mutate(
#     cut_spend = car::recode(as.numeric(v11), '8=NA;9=NA'),
#     spend_jobs = car::recode(as.numeric(v12), '1=5;2=4;3=3;4=2;5=1;else=NA'),
#     reg_biz = car::recode(as.numeric(v13), '8=NA;9=NA'),
#     sup_ind = car::recode(as.numeric(v14), '1=5;2=4;3=3;4=2;5=1;else=NA'),
#     sup_ind2 = car::recode(as.numeric(v15), '1=5;2=4;3=3;4=2;5=1;else=NA'),
#     gov_jobs = car::recode(as.numeric(v25), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_prices = car::recode(as.numeric(v26), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_health = car::recode(as.numeric(v27), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_old = car::recode(as.numeric(v28), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_ind3 = car::recode(as.numeric(v29), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_unemp = car::recode(as.numeric(v30), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_incd = car::recode(as.numeric(v31), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_house = car::recode(as.numeric(v33), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_laws = car::recode(as.numeric(v34), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_detain = car::recode(as.numeric(v41), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_surveil3 = car::recode(as.numeric(v42), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_surveil4 = car::recode(as.numeric(v43), '1=5;2=4;8=3;3=2;4=1;else=NA'),
#     gov_nosay = car::recode(as.numeric(v45), '1=5;2=4;3=3;4=2;5=1;else=NA'),
#     cntry = as.numeric(v3a),
#     cow = countrycode(cntry, origin = "iso3n", destination = "cown"),
#     wave = 2006
#   )%>%
#   arrange(cow)

issp16 <- issp16 %>%
  mutate(
    cut_spend = car::recode(as.numeric(v7), '8=NA;9=NA'),
    spend_jobs = car::recode(as.numeric(v8), '1=5;2=4;3=3;4=2;5=1;else=NA'),
    reg_biz = car::recode(as.numeric(v9), '8=NA;9=NA'),
    sup_ind = car::recode(as.numeric(v10), '1=5;2=4;3=3;4=2;5=1;else=NA'),
    sup_ind2 = car::recode(as.numeric(v11), '1=5;2=4;3=3;4=2;5=1;else=NA'),
    gov_jobs = car::recode(as.numeric(v21), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_prices = car::recode(as.numeric(v22), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_health = car::recode(as.numeric(v23), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_old = car::recode(as.numeric(v24), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_ind3 = car::recode(as.numeric(v25), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_unemp = car::recode(as.numeric(v26), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_incd = car::recode(as.numeric(v27), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_house = car::recode(as.numeric(v29), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_laws = car::recode(as.numeric(v30), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_surveil = car::recode(as.numeric(v38), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_surveil2 = car::recode(as.numeric(v39), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_open = car::recode(as.numeric(v40), '10=5;9=4.5;8=4;7=3.5;6=3.5;5=3;4=2.5;3=2.5;2=2;1=1.5;0=1;else=NA'),
    gov_secure = car::recode(as.numeric(v41), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_detain = car::recode(as.numeric(v43), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_surveil3 = car::recode(as.numeric(v44), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_surveil4 = car::recode(as.numeric(v45), '1=5;2=4;8=3;3=2;4=1;else=NA'),
    gov_nosay = car::recode(as.numeric(v47), '1=5;2=4;3=3;4=2;5=1;else=NA'),
    cntry = as.numeric(country),
    cow = countrycode(cntry, origin = "iso3n", destination = "cown"),
    wave = 2016
  )%>%
  arrange(cow)


issp16df <- select(issp16, cow, wave, cut_spend:gov_nosay)
# issp06df <- select(issp06, cow, wave, cut_spend:gov_nosay)
# df_issp <- merge(issp16df, issp06df, all = TRUE)

# surveil variables are all in issp16 so we do not really need to use issp06

issp16_meain <- issp16df[complete.cases(issp16df),]


# check measurement invariance - ISSP 2016
meaInmod <- "
  intervene =~ cut_spend + spend_jobs + reg_biz + sup_ind + sup_ind2 + gov_jobs + gov_prices + gov_health + gov_old + gov_ind3 + gov_unemp + gov_incd + gov_house + gov_laws + gov_surveil + gov_surveil2 + gov_open + gov_secure + gov_detain+ gov_surveil3 + gov_surveil4 + gov_nosay 
"
configural <- cfa(model = meaInmod, data = issp16_meain, group = "cow")
fitmeasures(configural)

# Hung: no measurement invariance at the configural level when pooling all variables together. 
# Now take only questions about government's inteverntion in unlikely events (public security, national security, terrorist act). THese questions only exists in issp16

meaInmod2a <- " 
  intervene_security =~ gov_surveil + gov_surveil2 + gov_secure" 
 
meaInmod2b <- " 
  intervene_security =~ 1*gov_surveil + 1.174*gov_surveil2 + 0.933*gov_secure 
  gov_surveil2 ~~ c(a,a,a,b,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a)*gov_secure
"

cfa2 <- cfa(model = meaInmod2a, data = issp16_meain)
summary(configural2,standardized = TRUE, fit.measures = TRUE)

configural2a <- cfa(model = meaInmod2, data = issp16_meain, group = "cow")
fitmeasures(configural2)

metric2a <- cfa(model = meaInmod2a, data = issp16_meain, group = "cow", group.equal = "loadings")
fitmeasures(metric2a)

metric2b <- cfa(model = meaInmod2b, data = issp16_meain, group = "cow")
fitmeasures(metric2b)


meaInmod3 <- " 
  intervene_econ =~ gov_jobs + gov_prices + gov_health + gov_old + gov_unemp 
"

configural3 <- cfa(model = meaInmod3, data = issp16_meain, group = "cow")
fitmeasures(configural3)


# create an authoritarian scale (just the surveillance items), maybe this is more the type of 'intervention' we want to measure. It is also the only one with measurement invariance at the configural level.


issp16_meain$gov_author <- round((issp16_meain$gov_surveil +
                                    1.174*issp16_meain$gov_surveil2 +
                                    0.933*issp16_meain$gov_secure)/3,2)





issp16dfa <- round(aggregate(issp16_meain, by = list(issp16_meain$cow), FUN = mean, na.rm = T),2)

issp16dfa <- dplyr::select(issp16dfa, cow, gov_author)


```



```{r clean covid}
covid <- covid %>%
  mutate(
    dpm = total_deaths_per_million, # deaths per million
    cow = countrycode(location, origin = "country.name", destination = "cown"),
  ) %>%
  select(cow, date, dpm) %>%
  filter(cow %in% issp16df$cow)

##  Stage 1: First half of March

dpm_stage1 <- filter(covid, covid$date >= "2020-03-01" & covid$date <= "2020-03-15")

dpm_stage1 <- round(aggregate(dpm_stage1[,-2], by = list(dpm_stage1$cow), FUN = mean, na.rm = TRUE),4)

dpm_stage1$dpm1 <- ifelse(is.nan(dpm_stage1$dpm), 0, dpm_stage1$dpm)

dpm_stage1 <- select(dpm_stage1, cow, dpm1)

## Stage 2: From March 16th to April 7th

dpm_stage2 <- filter(covid, covid$date >= "2020-03-16" & covid$date < "2020-04-07")

dpm_stage2 <- round(aggregate(dpm_stage2[,-2], by = list(dpm_stage2$cow), FUN = mean, na.rm = TRUE),4)

dpm_stage2$dpm2 <- ifelse(is.nan(dpm_stage2$dpm), 0, dpm_stage2$dpm)

dpm_stage2 <- select(dpm_stage2, cow, dpm2)

```





```{r clean_betrack, include = F}
betrack <- betrack %>%
  mutate(
    cow = countrycode(iso2c, origin = "iso2c", destination = "cown"),
    stay = beh_stayhome/20,
    gather = beh_socgathering/20,
    distance = beh_distance/20,
    tsymp = beh_tellsymp/20,
    hwash = beh_handwash/20
  ) %>%
  select(cow, date, stay, gather, distance, tsymp, hwash) 


```




```{r meaInbetrack}
## Measurement invariance - betrack

betrack_complete <- betrack[complete.cases(betrack),]
betrack_complete <- betrack_complete[which(betrack_complete$cow %in% issp16df$cow),]
betrack_complete <- betrack_complete[-which(betrack_complete$cow == 115),]
meaInmod4 <- "
  behave =~ stay + gather + distance
"
cfa4 <- cfa(model = meaInmod4, data = betrack_complete)
configural4 <- cfa(model = meaInmod4, data = betrack_complete, group = "cow")

metric4a <- cfa(model = meaInmod4, data = betrack_complete, group = "cow", group.equal = "loadings")
fitmeasures(metric4a)

meaInmod4b <- "
    behave =~ 1*stay + 0.776*gather + 1.083*distance
    stay ~~ c(a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,b,a,a,a,a,a,a,a,a)*gather
"

metric4b <- cfa(model = meaInmod4b, data = betrack_complete, group = "cow")

betrack$behave <- round((betrack$stay + 0.776*betrack$gather + 1.083*betrack$distance)/3,2)
betrack_av <- round(aggregate(betrack[,-2], by = list(betrack$cow), FUN = mean, na.rm = T),2)

```


```{r clean_blavatnik, warning = F, message = F}
## First stage: March 1st to March 15th
gov_resp1 <- gov_resp %>%
  mutate(
    date = as.Date(as.character(Date), "%Y%m%d"),
    chi = ContainmentHealthIndex/20,
    cow = countrycode(CountryName, origin = "country.name", destination = "cown")
  ) %>%
  filter(date > "2020-03-01" & date < "2020-03-15" & cow %in% issp16dfa$cow) %>%
  select(CountryName, date, chi)

gov_resp1 <- aggregate(x = gov_resp1[,-2], by = list(gov_resp1$CountryName), FUN = mean)

gov_resp1 <- gov_resp1 %>%
  mutate(
    cname = Group.1,
    cow = countrycode(cname, origin = "country.name", destination = "cown"), 
    chi1 = round(chi,2)
  ) %>% 
  select(cow, chi1) %>%
  arrange(cow)

## Second stage: March 15th to March 31st

gov_resp2 <- gov_resp %>%
  mutate(
    date = as.Date(as.character(Date), "%Y%m%d"),
    chi = ContainmentHealthIndex/20,
    cow = countrycode(CountryName, origin = "country.name", destination = "cown")
  ) %>%
  filter(date > "2020-03-16" & date < "2020-03-31" & cow %in% issp16dfa$cow) %>%
  select(CountryName, date, chi)

gov_resp2 <- aggregate(x = gov_resp2[,-2], by = list(gov_resp2$CountryName), FUN = mean)

gov_resp2 <- gov_resp2 %>%
  mutate(
    cname = Group.1,
    cow = countrycode(cname, origin = "country.name", destination = "cown"), 
    chi2 = round(chi,2)
  ) %>% 
  select(cow, chi2) %>%
  arrange(cow)

```

Income Inequality 

```{r clean_solt, warning = F, message = F}
rm(swiid)
swiid_summary$cow <- countrycode(swiid_summary$country, "country.name", "cown")

#some countries do not have data since 2016, take most recent available year
swiid_summary <- swiid_summary %>%
  mutate(year = ifelse(country == "Algeria" & year == 2011 | country == "Brunei" & year == 1981 | country == "Bosnia and Herzegovina" & year == 2015 | country == "Grenada" & year == 2008 | country == "Guatemala" & year == 2014 | country == "Iceland" & year == 2015 | country == "India" & year == 2012 | country == "Japan" & year == 2015 | country == "Morocco" & year == 2014 | country == "Pakistan" & year == 2015 | country == "Philippines" & year == 2015 | country == "South Africa" & year == 2015 | country == "United Arab Emirates" & year == 2008, 2016, year))

# trim S. Africa
swiid_summary$gini_disp <- ifelse(swiid_summary$country == "South Africa" & swiid_summary$year == 2016, 55, swiid_summary$gini_disp)


swiid_summary <- subset(swiid_summary, year >= 2016)
swiid_summary <- select(swiid_summary, cow, gini_disp)
swiid_summary <- aggregate(swiid_summary, by = list(swiid_summary$cow), FUN = mean, na.rm = T)
gini_disp <- select(swiid_summary, cow, gini_disp)
rm(swiid_summary)



```


```{r merge_clean}
betrack_av <- betrack_av %>% 
    filter(cow %in% issp16dfa$cow) %>%
    select(cow, behave)


df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")


## filter out suriname 
df <- df[-which(df$cow==115),]

## Add control variables
finaldf_Ca <- finaldf_Ca %>%
  filter(cow %in% issp16dfa$cow) 
df <- left_join(df, finaldf_Ca, by = "cow")

## Create a discrepancy index

df$discrep <- df$chi2 - df$gov_author





```


## Now start with some descriptive statistics 




```{r corrs}
cor <- select(df, concern_self, days_since_peak, conf_delta, gov_resp, stay, gini_disp, top1, socpolicy, gdp)
f1 <- cor(cor, use = "pairwise.complete.obs")


cor1 <- kable(f1, digits = 2, col.names = c("Risk Perception", "Days Since Peak", "New Cases Past Week","Severity of Gov Response", "Timing of Gov Response", "Gini, disposable", "Welfare State", "GDP, per capita"))

kable_styling(cor1)
```




```{r plot1}
ggplot(df, aes(y=gov_resp, x=gov_intv)) +
  geom_point() +
  geom_text(aes(label=iso), vjust = 1.5) +
  geom_smooth(method=lm, se=FALSE) +
  xlab("General Public Preferences for Government Intervention") +
  ylab("Severity of Government Pandemic Measures") +
  theme_classic()
  
```

```{r plot2}
ggplot(df, aes(y=gov_resp, x=gov_ineq)) +
  geom_point() +
  geom_text(aes(label=iso), vjust = 1.5) +
  geom_smooth(method=lm, se=FALSE) +
  xlab("Public Preferences for Government Redistribution") +
  ylab("Severity of Government Pandemic Measures") +
  theme_classic()
  
```
```{r plot3}
ggplot(df, aes(y=gov_resp, x=gini_disp)) +
  geom_point() +
  geom_text(aes(label=iso), vjust = 1.5) +
  geom_smooth(method=lm, se=FALSE) +
  xlab("Gini, post-tax and transfer") +
  ylab("Severity of Government Pandemic Measures") +
  theme_classic()
  
```




```{r plot4}
ggplot(df, aes(y=concern_self, x=gov_resp)) +
  geom_point() +
  geom_text(aes(label=iso), vjust = 1.5) +
  geom_smooth(method=lm, se=FALSE) +
  xlab("Severity of Government Pandemic Measures") +
  ylab("Risk Perceptions") +
  theme_classic()
  
```


```{r adjusted_risk}

# adjust risk for severity of outbreak
m1 <- lm(concern_self ~ days_since_peak + conf_delta + chi, data = df)

# predicted values
df$m1p <- predict.lm(m1, df)

# residuals
df$m1r <- df$concern_self - df$m1p 

# plot fitted v observed
ggplot(df, aes(y=m1p, x=concern_self)) +
  geom_point() +
  geom_text_repel(aes(label=iso), vjust = 1.5) +
  geom_abline(slope=1) +

  xlab("Observed Risk Perceptions") +
  ylab("Predicted Risk Perceptions") +
  theme_classic()

#   geom_smooth(method=lm, se=FALSE) +

mx <- lm(m1r ~ gini_disp, data = df)
summary(mx)
  
```


```{r plot6}


ggplot(df, aes(y=m1r, x=gini_disp)) +
  geom_smooth(method=lm, se=FALSE) +
  geom_text_repel(aes(label=iso), size = 3) +
  xlab("Income Inequality, post-tax and transfer gini") +
  ylab("Risk Perceptions, M1 residuals") +
  theme_classic()

#   
```
```{r plot7}


ggplot(df, aes(y=m1r, x=socpolicy)) +
  geom_smooth(method=lm, se=FALSE) +
  geom_label_repel(aes(label=iso), size = 2.5) +
  xlab("Welfare State, spending and coverage") +
  ylab("Risk Perceptions, M1 residuals") +
  theme_classic()

#   
```


```{r plot8}


ggplot(df, aes(y=m1r, x=gdp)) +
  geom_smooth(method=lm, se=FALSE) +
  geom_label_repel(aes(label=iso), size = 2.5) +
  xlab("GDP, per capita parity") +
  ylab("Risk Perceptions, M1 residuals") +
  theme_classic()

#   
```
```{r plot9}
mid <- 34
# trim gini to get better color display
df$gini_color <- ifelse(df$gini_disp<45, df$gini_disp, 45)

ggplot(data=df, aes(x=conf_delta, y=concern_self, color = gini_color)) +
  geom_point() +
  geom_smooth(method=lm, se=FALSE, color = "gray50", linetype = "dashed") +
  geom_text_repel(aes(label = iso), size = 2.8) +
  scale_color_gradient2(midpoint=mid, low="blue", mid="gray55", high="red", space="Lab") +
  labs(x= "New Case Rate, past week", y = "Coronavirus Concerns", color = "Income Inequality\n(Gini, post\ntax & transfer)") +
      theme(panel.background = element_rect(fill = "white", colour = "grey50"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.title = element_text(size = 10))
```


## Stage 1
```{r }

m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)

m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)

m13 <- lm(chi1 ~ dpm1 + gov_author + socpolicy, data = df)

m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)

m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + socpolicy + gdp, data = df)

tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F, rm.terms = c("(Intercept)"),  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Deaths per Million", "Public Prefrence", "Disposable Income Inequality", "Welfare State Strength", "GDP Per Capita"))
```


## Stage 2

```{r q2reg}

# m1x <- lm(concern_self ~ days_since_peak + conf_delta + gov_resp*intervention, data = df)
m21 <- lm(behave ~ dpm2 + discrep, data = df)

m22 <- lm(behave ~ dpm2 + discrep + gini_disp, data = df)

m23 <- lm(behave ~ dpm2 + discrep + socpolicy, data = df)

m24 <- lm(behave ~ dpm2 + discrep + gdp, data = df)

m25 <- lm(behave ~ dpm2 + discrep + gini_disp + socpolicy + gdp, data = df)

tab_model(m21, m22, m23, m24, m25, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F, rm.terms = c("(Intercept)"),  dv.labels = c("M21", "M22","M23", "M24","M25"), pred.labels = c("Deaths per Million", "Discrepancy Index", "Disposable Income Inequality", "Welfare State Strength", "GDP Per Capita"))
```

```{r q2reg2}

# m1x <- lm(concern_self ~ days_since_peak + conf_delta + gov_resp*intervention, data = df)
m21b <- lm(gather ~ days_since_peak + conf_delta + chi, data = df)

m22b <- lm(gather ~ days_since_peak + conf_delta + chi + gini_disp, data = df)

m23b <- lm(gather ~ days_since_peak + conf_delta + chi + socpolicy, data = df)

m24b <- lm(gather ~ days_since_peak + conf_delta + chi + gdp, data = df)

m25b <- lm(gather ~ days_since_peak + conf_delta + chi + gini_disp + socpolicy + gdp, data = df)

tab_model(m21b, m22b, m23b, m24b, m25b, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F, rm.terms = c("(Intercept)"),  dv.labels = c("M1", "M2","M3", "M4","M5","M6"), pred.labels = c("Days Since Curve Inflection", "New Case Rate", "Intervention Severity", "Disposable Income Inequality", "Welfare State Strength", "GDP Per Capita"))
```

```{r q2reg3}

# m1x <- lm(concern_self ~ days_since_peak + conf_delta + gov_resp*intervention, data = df)
m21c <- lm(distance ~ days_since_peak + conf_delta + chi, data = df)

m22c <- lm(distance ~ days_since_peak + conf_delta + chi + gini_disp, data = df)

m23c <- lm(distance ~ days_since_peak + conf_delta + chi + socpolicy, data = df)

m24c <- lm(distance ~ days_since_peak + conf_delta + chi + gdp, data = df)

m25c <- lm(distance ~ days_since_peak + conf_delta + chi + gini_disp + socpolicy + gdp, data = df)

tab_model(m21c, m22c, m23c, m24c, m25c, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F, rm.terms = c("(Intercept)"),  dv.labels = c("M1", "M2","M3", "M4","M5","M6"), pred.labels = c("Days Since Curve Inflection", "New Case Rate", "Intervention Severity", "Disposable Income Inequality", "Welfare State Strength", "GDP Per Capita"))
```


```{r mediation}
mod2 <- "
  # indirect effects
  # direct effects
  
"
```


```{r std_reg}
tab_model(m1, m2, m3, m4, m5, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F, rm.terms = c("(Intercept)"), show.std = T, dv.labels = c("M3"), pred.labels = c("Days Since Curve Inflection", "New Case Rate", "Intervention Severity", "Disposable Income Inequality", "Welfare State Strength", "GDP Per Capita"))
```




